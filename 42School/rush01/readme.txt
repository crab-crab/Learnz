Depth first search with backtracking approach